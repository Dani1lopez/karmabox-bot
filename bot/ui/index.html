<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>KarmaBox — Leads</title>

    <link rel="stylesheet" href="./assets/css/app.css" />
    <meta name="color-scheme" content="dark light" />
</head>

<body>
    <header class="topbar">
        <div class="brand">
            <div class="logo" aria-hidden="true">KB</div>
            <div class="brand-text">
                <h1>KarmaBox</h1>
                <p>Gestión de leads · UI MVP</p>
            </div>
        </div>

        <div class="topbar-actions">
            <button id="btnRefresh" class="btn btn-ghost" type="button" title="Recargar">
                <span class="icon" aria-hidden="true">↻</span>
                Recargar
            </button>
            <div class="badge" title="Total leads">
                <span id="totalCount">0</span>
            </div>
        </div>
    </header>

    <main class="layout">
        <!-- Left: list -->
        <section class="card">
            <div class="card-head">
                <div class="filters">
                    <label class="field">
                        <span>Buscar</span>
                        <input id="q" type="search" placeholder="Nombre, apellidos, teléfono, dirección o ID…"
                            autocomplete="off" />
                    </label>

                    <label class="field">
                        <span>Orden</span>
                        <select id="sort">
                            <option value="created_desc">Más recientes</option>
                            <option value="created_asc">Más antiguos</option>
                            <option value="name_asc">Nombre A–Z</option>
                            <option value="name_desc">Nombre Z–A</option>
                        </select>
                    </label>

                    <label class="field">
                        <span>Por página</span>
                        <select id="pageSize">
                            <option value="10">10</option>
                            <option value="20" selected>20</option>
                            <option value="50">50</option>
                        </select>
                    </label>
                </div>

                <div class="meta">
                    <span id="lastSync" class="muted">—</span>
                    <span id="statusDot" class="dot" aria-hidden="true"></span>
                </div>
            </div>

            <div class="table-wrap">
                <table class="table" aria-label="Leads">
                    <thead>
                        <tr>
                            <th>Lead</th>
                            <th>Teléfono</th>
                            <th>Dirección</th>
                            <th>Alta</th>
                            <th class="th-actions">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="rows">
                        <!-- rows -->
                    </tbody>
                </table>

                <div id="emptyState" class="empty" hidden>
                    <div class="empty-title">No hay resultados</div>
                    <div class="empty-sub">Prueba a cambiar el filtro o recargar.</div>
                </div>

                <div id="loadingState" class="loading" hidden>
                    <div class="spinner" aria-hidden="true"></div>
                    <div>Cargando leads…</div>
                </div>
            </div>

            <div class="card-foot">
                <div class="pagination">
                    <button id="prevPage" class="btn btn-ghost" type="button">←</button>
                    <div class="page-info">
                        <span class="muted">Página</span>
                        <span id="pageNow" class="mono">1</span>
                        <span class="muted">de</span>
                        <span id="pageTotal" class="mono">1</span>
                    </div>
                    <button id="nextPage" class="btn btn-ghost" type="button">→</button>
                </div>

                <div class="hint muted">
                    Click en <b>Editar</b> para modificar un lead con <span class="mono">PATCH /leads/{id}</span>.
                </div>
            </div>
        </section>

        <!-- Right: quick panel -->
        <aside class="card side">
            <div class="side-head">
                <h2>Detalle rápido</h2>
                <p class="muted">Selecciona un lead para ver información.</p>
            </div>

            <div class="side-body" id="detail">
                <div class="kv">
                    <div class="k">ID</div>
                    <div class="v mono" id="d_id">—</div>
                </div>
                <div class="kv">
                    <div class="k">Creado</div>
                    <div class="v mono" id="d_created">—</div>
                </div>
                <div class="kv">
                    <div class="k">Nombre</div>
                    <div class="v" id="d_name">—</div>
                </div>
                <div class="kv">
                    <div class="k">Apellidos</div>
                    <div class="v" id="d_last">—</div>
                </div>
                <div class="kv">
                    <div class="k">Teléfono</div>
                    <div class="v mono" id="d_phone">—</div>
                </div>
                <div class="kv">
                    <div class="k">Dirección</div>
                    <div class="v" id="d_address">—</div>
                </div>

                <div class="side-actions">
                    <button id="btnCopyId" class="btn btn-ghost" type="button" disabled>Copiar ID</button>
                    <button id="btnOpenEdit" class="btn btn-primary" type="button" disabled>Editar</button>
                </div>
            </div>
        </aside>
    </main>

    <!-- Modal -->
    <div class="modal-backdrop" id="modalBackdrop" hidden></div>

    <dialog class="modal" id="modal">
        <form method="dialog" class="modal-content" id="editForm">
            <div class="modal-head">
                <div>
                    <h3>Editar lead</h3>
                    <p class="muted mono" id="m_id">—</p>
                </div>
                <button class="btn btn-ghost" type="button" id="btnClose" aria-label="Cerrar">✕</button>
            </div>

            <div class="modal-body">
                <div class="grid">
                    <label class="field">
                        <span>Nombre</span>
                        <input id="m_name" type="text" placeholder="Nombre" />
                    </label>

                    <label class="field">
                        <span>Apellidos</span>
                        <input id="m_last_name" type="text" placeholder="Apellidos" />
                    </label>

                    <label class="field">
                        <span>Teléfono</span>
                        <input id="m_phone" type="text" placeholder="Ej: 687909890" />
                        <small class="muted">Validación final en API (teléfono ES).</small>
                    </label>

                    <label class="field">
                        <span>Dirección</span>
                        <input id="m_address" type="text" placeholder="Dirección" />
                    </label>
                </div>

                <div class="modal-msg mono" id="m_msg"></div>
            </div>

            <div class="modal-foot">
                <button class="btn btn-ghost" type="button" id="btnReset">Revertir</button>
                <div class="spacer"></div>
                <button class="btn btn-ghost" type="button" id="btnCancel">Cancelar</button>
                <button class="btn btn-primary" type="submit" id="btnSave">Guardar</button>
            </div>
        </form>
    </dialog>

    <!-- Toast -->
    <div class="toast" id="toast" hidden>
        <div class="toast-body" id="toastText">—</div>
    </div>

    <script src="./assets/js/app.js"></script>
</body>

</html>